---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Learn about Mahad" } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="generator" content={Astro.generator} />

    <!-- Favicon - simple SVG -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' font-family='Georgia,serif'>M</text></svg>" />

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Theme Script - runs before render to prevent flash -->
    <script is:inline>
      (function() {
        const theme = localStorage.getItem('theme') ||
          (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
      })();
    </script>

    <title>{title}</title>
  </head>
  <body id="top">
    <Header />
    <main>
      <slot />
    </main>
    <Footer />

    <!-- Scroll to top button -->
    <button class="scroll-top" aria-label="Scroll to top">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 15l-6-6-6 6"/>
      </svg>
    </button>

    <!-- Scroll reveal animation script -->
    <script>
      const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, observerOptions);

      document.querySelectorAll('.reveal').forEach(el => {
        observer.observe(el);
      });

      // Scroll to top button
      const scrollTopBtn = document.querySelector('.scroll-top');

      window.addEventListener('scroll', () => {
        if (window.scrollY > 500) {
          scrollTopBtn?.classList.add('visible');
        } else {
          scrollTopBtn?.classList.remove('visible');
        }
      });

      scrollTopBtn?.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    </script>

    <style>
      .scroll-top {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--color-bg-elevated);
        border: 1px solid var(--color-border);
        border-radius: 50%;
        color: var(--color-text);
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
        transition: all 0.3s ease;
        z-index: 50;
        box-shadow: var(--shadow-md);
      }

      .scroll-top:hover {
        border-color: var(--color-accent);
        color: var(--color-accent);
        transform: translateY(-2px);
      }

      .scroll-top.visible {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      @media (max-width: 640px) {
        .scroll-top {
          bottom: 1.5rem;
          right: 1.5rem;
          width: 44px;
          height: 44px;
        }
      }
    </style>
  </body>
</html>
